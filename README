Copyright 2024 Obreja Ana-Maria Grupa 321CA
Tema 1 - Dataplane Router
Protocoale de comunicatii

In tema am implementat:
- Protocolul IPV4
- Protocolul ARP
- Protocolul ICMP
- Longest Prefix Match eficient 


Programul simuleaza functionalitatile unui router, care poate primi
pachete de tip IP, ARP request/reply, ICMP. 

1. Protoculul IPV4

Router-ul primeste un pachet cu protocolul IP. Verifica intai suma 
de control. Daca cea trimisa in interiorul pachetului
nu corespunde cu cea calculata dupa ce acesta a fost primit, router-ul
va da drop pachetului. Acum este verificat parametrul ttl
(time to live), folosit pentru cazurile in care pachetul este dirijat
intr-un loop. La fiecare trimitere a pachetului, ttl-ul este decrementat.
Daca acesta ajunge la valoarea 0 sau 1, pachetul nu va mai fi dirijat
catre urmatorul nod din retea, iar router-ul va trimite un pachet de
tip ICMP. Daca pachetul este destinat router-ului (adresa IP din header-ul
IP de destinatie este echivalenta cu cea a router-ului), acesta va timite
un pachet de tip ICMP inapoi.

Dupa ce au fost realizate aceste verificari, se decrementeaza ttl-ul,
se recalculeaza suma de control si se cauta cea mai buna intrare in tabela
de routare. Daca nu a fost gasita, inseamna ca nu stim care este next-hop,
respectiv pe ce interfata a router-ului sa trimitem pachetul, astfel se
trimite un pachet ICMP corespunzator si se da drop.

Daca am gasit intrarea cautata, vom cauta in tabela dinamica intrarea care
contine adrese IP si adrese MAC (intr-o structura). Vom compara adresa urma-
torului hop cu cele IP din tabela, pentru a ajunge la adresa MAC necesara
pentru a schimba datele din header-ul ether si trimite pachetul. Pentru ca
tabela arp este populata dinamic, daca nicio adresa IP nu se potriveste (nu
gasim intrarea buna in tabela), vom trimite o cerere de tip broadcast
tuturor nodurilor adiacente din retea (adresa MAC e de forma:
ff.ff.ff.ff.ff.ff), iar pachetul este pus in coada pana primim un raspuns
relevant.

2. Protocolul ARP

a) ARP request

Router-ul primeste o cerere de tip broadcast (asa cum am trimis in sectiunea
IPV4) si, daca adresa lui IP este echivalenta cu cea cautata de sursa
cererii, se construieste un pachet de tip ARP_REPLY si este trimis
catre sursa.

b) ARP reply

Un nod din retea a raspuns la cererea de tip broadcast (are adresa IP
ceruta). Cautam in coada de pachete care asteapta un astfel de raspuns
si il trimitem catre nodul din retea corespunzator. 

3. Protocolul ICMP

In cadrul protocolului ICMP construim un pachet care este trimis catre
sursa initiala si are proprietatea de a semnala o problema in dirijarea
pachetului sau este de tip "Echo reply".

4. LPM (Longest Prefix Match)

Pentru a face cautarea mai eficienta, am folosit qsort predefinita pentru a
sorta intrarile din tabela de routare in functie de prefix si de masca
(crescator), iar cautarile din IPV4 au fost facute cu binary search.


Feedback: Tema a fost interesanta, iar lectura recomandata pentru realizarea
temei s-a dovedit foarte utila. In schimb, checker-ul a fost foarte dificil
de folosit; uneori treceau testele, alteori nu, fara sa schimb nimic in cod.